var L=Object.defineProperty;var x=(c,e,t)=>e in c?L(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var n=(c,e,t)=>(x(c,typeof e!="symbol"?e+"":e,t),t);import{D as E,G as C,M as S,a as w,F as j,A as F,W as D,S as k,C as P,s as b,b as A,c as O,O as M,d as v,P as N,E as z}from"./vendor.a5798aca.js";const R=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}};R();const d=class{constructor(e,t,r="default"){n(this,"start");n(this,"update");n(this,"loadModel",e=>{if(typeof e!="string")throw Error("expected type string for url");let t=s=>{s.scene.traverse(function(p){p instanceof w&&(p.castShadow=!0,p.material.side=j)}),this.scene.add(s.scene),this.mesh=s.scene,this.animations=[],this.mixer=new F(this.mesh),s.animations.forEach(p=>{{let g=this.mixer.clipAction(p);this.animations.push(g),g.play(),g.weight=0}}),console.log("Animation reference project : https://codepen.io/b29/pen/MPmqLo"),console.log("Animation reference project : https://github.com/mrdoob/three.js/blob/master/examples/webgl_animation_skinning_blending.html"),this.loaded=!0,typeof this.start=="function"&&this.start()},r=s=>{console.log(s.loaded/s.total*100+"% loaded")},o=s=>{console.log("An error happened"),console.log(s)},i=e.split("."),l=i[i.length-1].toLowerCase();if(l==="drc")this.dracoLoad(e);else if(l==="gltf"||l==="glb")this.gltfLoader(e,t,r,o);else throw Error("Extension "+l+" is not supported")});n(this,"gltfLoader",(e,t,r,o)=>{if(typeof t!="function"){console.log("%cExpected function for onLoad event of model gltf loading","background: #ff0000; color: #000000; font-weight: 800");return}if(typeof r!="function"){console.log("%cExpected function for onProgress event of model gltf loading","background: #ff0000; color: #000000; font-weight: 800");return}if(typeof o!="function"){console.log("%cExpected function for onError event of model gltf loading","background: #ff0000; color: #000000; font-weight: 800");return}d.gltfLoader.load(e,t,r,o)});n(this,"dracoLoad",e=>{d.dracoLoader.load(e,t=>{const r=new S({color:6316128});this.mesh=new w(t,r),this.scene.add(this.mesh),typeof this.start=="function"&&this.start(),this.loaded=!0,console.log("loaded : ",{Layer:this.layer,ObjectName:this.gameObjectName}),d.dracoLoader.dispose()},t=>{console.log(t.loaded/t.total*100+"% loaded")},t=>{console.log("An error happened"),console.log(t)})});n(this,"animate",e=>{this.mixer.update(e)});if(typeof e!="string")throw Error("expected type string for name");if(typeof r!="string")throw Error("expected type string for layer");this.gameObjectName=e,this.layer=r,this.scene=t,this.loaded=!1,d.dracoLoader.setDecoderPath("/engine3/dracodecoder/"),d.dracoLoader.setDecoderConfig({type:"js"}),d.gltfLoader.setDRACOLoader(d.dracoLoader),d.dracoLoader.preload()}};let m=d;n(m,"dracoLoader",new E),n(m,"gltfLoader",new C);const h=class{constructor(e){h.scene=e,h.gameObjects=[]}};let f=h;n(f,"gameObjects"),n(f,"createScript",e=>{let t=new m(e,h.scene);return h.gameObjects.push(t),t});const y=class{constructor(e,t,r,o=1,i=1,l=-1){n(this,"keyUpFlag",!1);n(this,"keyDownFlagP",!1);n(this,"keyDownFlagN",!1);n(this,"update",()=>{if(this.keyUpFlag){let e=this.value;e>0?(e-=this.gravity,e<=0?this.value=0:this.value=e):e<0?(e+=this.gravity,e>=0?this.value=0:this.value=e):this.keyUpFlag=!1}if(this.keyDownFlagP){let e=this.value;e+=this.gravity,e>=this.max?this.value=this.max:this.value=e}if(this.keyDownFlagN){let e=this.value;e-=this.gravity,e<=this.min?this.value=this.min:this.value=e}});this.gravity=o,this.min=l,this.max=i,this.name=e,this.positiveKey=t,this.negativeKey=r,this.value=0,y.InputCollection.push(this),document.addEventListener("keypress",s=>{s.key===this.positiveKey&&(this.keyDownFlagP=!0,this.keyUpFlag=!1),s.key===this.negativeKey&&(this.keyDownFlagN=!0,this.keyUpFlag=!1)}),document.addEventListener("keyup",s=>{(s.key===this.positiveKey||s.key===this.negativeKey)&&(this.keyDownFlagP=!1,this.keyDownFlagN=!1,this.keyUpFlag=!0)})}};let u=y;n(u,"InputCollection",[]);class W{constructor(){n(this,"init",(e,t,r,o=!1)=>{if(!e instanceof k)throw Error("expected object of type THREE.Scene for scene");if(!t instanceof P)throw Error("expected object of type THREE.Camera for camera");if(this.currentScene=e,this.objectFactory=new f(e),this.mainCam=t,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.outputEncoding=b,this.renderer.shadowMap.enabled=!0,this.mainCam.position.setZ(5),this.clock=new A,r!==void 0){const s=new O().load(r);s.encoding=b,this.currentScene.background=s,console.log("Skybox reference project : https://codepen.io/codypearce/pen/oNXQyOb")}o&&new M(this.mainCam,this.renderer.domElement).update();const i=new v(15724543,3);i.position.set(1,1,1).normalize(),e.add(i);const l=new v(16773103,3);l.position.set(-1,-1,-1).normalize(),e.add(l),window.addEventListener("resize",this.onWindowResize),this.renderer.render(e,t),this.gameLoop()});n(this,"onWindowResize",()=>{this.mainCam.aspect=window.innerWidth/window.innerHeight,this.mainCam.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)});n(this,"gameLoop",()=>{this.renderer.render(this.currentScene,this.mainCam),requestAnimationFrame(this.gameLoop);let e=this.clock.getDelta();u.InputCollection.forEach(t=>{typeof t.update=="function"&&t.update()}),f.gameObjects.forEach(t=>{t.loaded===!0&&(typeof t.update=="function"&&t.update(e),typeof t.animate=="function"&&t.animate(e))})});this.renderer=new D({canvas:document.querySelector("#app"),antialias:!0})}}let K=new W,H=new k,T=new N(75,window.innerWidth/window.innerHeight,.1,1e3);K.init(H,T,["https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_ft.jpg","https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_bk.jpg","https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_up.jpg","https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_dn.jpg","https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_rt.jpg","https://raw.githubusercontent.com/codypearce/some-skyboxes/master/skyboxes/flame/flame_lf.jpg"],!0);const a=f.createScript("Bunny");a.loadModel("./../engine3/assets/Soldier.glb");a.start=()=>{a.mesh.scale.set(1,1,1),a.animations[0].weight=1,a.horizontal=new u("horizontal","a","d",1),a.vertical=new u("vertical","w","s",.01),document.addEventListener("keypress",c=>{c.key==="f"&&(a.mesh.rotation.set(new z(0,1,1.57,"XYZ")),console.log(a.mesh.rotation))})};a.update=c=>{let e=1-a.vertical.value;e>1&&(e=1),a.animations[0].weight=e,a.animations[1].weight=a.vertical.value,console.log(a.vertical.value);let t=2;a.mesh.rotation.y+=t*Math.ceil(a.horizontal.value)*c};
